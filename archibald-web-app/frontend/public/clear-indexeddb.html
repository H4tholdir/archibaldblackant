<!DOCTYPE html>
<html>
<head>
  <title>Clear IndexedDB</title>
</head>
<body>
  <h1>Clearing IndexedDB...</h1>
  <div id="status">In progress...</div>
  <script>
    async function clearAllDatabases() {
      try {
        // Delete ArchibaldOfflineDB
        await new Promise((resolve, reject) => {
          const request = indexedDB.deleteDatabase('ArchibaldOfflineDB');
          request.onsuccess = () => {
            console.log('ArchibaldOfflineDB deleted');
            resolve();
          };
          request.onerror = () => {
            console.error('Error deleting ArchibaldOfflineDB');
            reject(request.error);
          };
          request.onblocked = () => {
            console.warn('Delete blocked - close other tabs');
          };
        });

        // Delete ArchibaldCredentials
        await new Promise((resolve, reject) => {
          const request = indexedDB.deleteDatabase('ArchibaldCredentials');
          request.onsuccess = () => {
            console.log('ArchibaldCredentials deleted');
            resolve();
          };
          request.onerror = () => {
            console.error('Error deleting ArchibaldCredentials');
            reject(request.error);
          };
        });

        document.getElementById('status').innerHTML = '✅ All IndexedDB databases cleared!<br><br><a href="/orders">Go to Orders page</a>';
      } catch (error) {
        document.getElementById('status').innerHTML = '❌ Error: ' + error.message;
        console.error('Error clearing databases:', error);
      }
    }

    clearAllDatabases();
  </script>
</body>
</html>
