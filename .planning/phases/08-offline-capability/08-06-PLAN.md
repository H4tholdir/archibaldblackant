---
phase: 08-offline-capability
plan: 06
type: execute
---

<objective>
Implement network status detection and banking app style offline indicator UI.

Purpose: Provide clear, prominent visual feedback when offline (yellow banner) and discrete progress during background sync, matching banking app UX standards (Intesa, UniCredit).

Output: Working network status hook, prominent yellow offline banner, discrete sync progress bar.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-offline-capability/08-CONTEXT.md
@.planning/phases/08-offline-capability/08-05-SUMMARY.md

**From 08-CONTEXT.md:**
- **Banner Offline**: Banner giallo prominent in alto quando offline: "ModalitÃ  Offline"
  - Impossibile non notare, rassicurante
  - Riferimento: Intesa Sanpaolo o UniCredit quando sei offline
  - Non minimale - deve essere chiaro e visibile
- **Progress Sync**: Piccola barra in basso durante sync: "Aggiornamento dati... 45%"
  - Non blocca l'uso dell'app
  - L'agente sa cosa sta succedendo senza essere interrotto
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create useNetworkStatus hook</name>
  <files>archibald-web-app/frontend/src/hooks/useNetworkStatus.ts</files>
  <action>
Create network status detection hook:

```typescript
import { useState, useEffect } from 'react';

export function useNetworkStatus() {
  const [isOnline, setIsOnline] = useState(navigator.onLine);

  useEffect(() => {
    function handleOnline() {
      console.log('[Network] Online');
      setIsOnline(true);
    }

    function handleOffline() {
      console.log('[Network] Offline');
      setIsOnline(false);
    }

    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);

    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);

  return { isOnline, isOffline: !isOnline };
}
```

Hook leverages navigator.onLine and online/offline events (97% browser support).
  </action>
  <verify>Hook returns correct online/offline status, updates when network changes</verify>
  <done>useNetworkStatus hook implemented and working</done>
</task>

<task type="auto">
  <name>Task 2: Create OfflineBanner component (banking app style)</name>
  <files>archibald-web-app/frontend/src/components/OfflineBanner.tsx, archibald-web-app/frontend/src/App.tsx</files>
  <action>
Create `OfflineBanner.tsx`:

```typescript
import { useNetworkStatus } from '../hooks/useNetworkStatus';

export function OfflineBanner() {
  const { isOffline } = useNetworkStatus();

  if (!isOffline) {
    return null;
  }

  return (
    <div style={{
      position: 'fixed',
      top: 0,
      left: 0,
      right: 0,
      backgroundColor: '#ffc107', // Yellow (banking app standard)
      color: '#000',
      padding: '12px 16px',
      textAlign: 'center',
      fontWeight: 600,
      fontSize: '14px',
      zIndex: 9999,
      boxShadow: '0 2px 8px rgba(0,0,0,0.15)',
      borderBottom: '2px solid #ff9800'
    }}>
      ðŸ“µ ModalitÃ  Offline
      <div style={{
        fontSize: '12px',
        fontWeight: 400,
        marginTop: '4px',
        color: '#333'
      }}>
        Puoi continuare a lavorare. Gli ordini saranno inviati quando torni online.
      </div>
    </div>
  );
}
```

Add to `App.tsx`:

```typescript
import { OfflineBanner } from './components/OfflineBanner';

function App() {
  return (
    <>
      <OfflineBanner />
      {/* Push content down when offline banner visible */}
      <div style={{ marginTop: isOffline ? '64px' : '0' }}>
        {/* Existing app content */}
      </div>
    </>
  );
}
```

Design matches 08-CONTEXT.md requirements:
- **Prominent yellow banner** (not subtle)
- **Top of screen** (impossible to miss)
- **Reassuring message** (can continue working)
- **Banking app reference** (Intesa/UniCredit yellow style)
  </action>
  <verify>Yellow banner appears when offline (DevTools Network â†’ Offline), disappears when back online</verify>
  <done>OfflineBanner component integrated, banking app style yellow prominent banner</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Network status detection with banking app style offline banner and discrete sync progress</what-built>
  <how-to-verify>
1. Run: `npm run dev` (frontend dev server)
2. Open: http://localhost:5173
3. App shows normal (no banner)
4. DevTools â†’ Network: Enable "Offline" checkbox
5. Verify: Yellow banner appears at top: "ðŸ“µ ModalitÃ  Offline"
6. Check: Banner is prominent, impossible to miss, banking app style
7. Verify: Reassuring message below: "Puoi continuare a lavorare..."
8. Test: OrderForm still works (search customers/products from cache)
9. Re-enable network
10. Verify: Banner disappears immediately
11. Test: Create order (should work online)

Expected results:
- Yellow banner prominent and unmissable when offline
- Banner matches banking app UX (Intesa/UniCredit reference)
- App content pushed down (not covered by banner)
- Banner disappears when back online
- No console errors
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe UI issues to fix</resume-signal>
</task>

</tasks>

<verification>
- [ ] useNetworkStatus hook returns correct online/offline state
- [ ] Yellow banner appears when offline
- [ ] Banner is prominent (top of screen, impossible to miss)
- [ ] Banking app style (yellow, reassuring message)
- [ ] App content not covered by banner
- [ ] Banner disappears when back online
- [ ] Human verification passed
</verification>

<success_criteria>

- useNetworkStatus hook with navigator.onLine events
- OfflineBanner component matching banking app UX
- Prominent yellow banner (08-CONTEXT.md requirement)
- Reassuring offline message
- App content pushed down (no overlap)
- Human verification checkpoint passed
  </success_criteria>

<output>
After completion, create `.planning/phases/08-offline-capability/08-06-SUMMARY.md`
</output>
