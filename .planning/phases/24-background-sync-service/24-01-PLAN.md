---
phase: 24-background-sync-service
plan: 01
type: execute
---

<objective>
Implement Service Worker for silent background syncs every 30 minutes.

Purpose: Enable PWA background sync for offline-first experience without user interaction.
Output: Service Worker with Background Sync API integration, silent 30-min sync cycles.
</objective>

<context>
**PWA Background Sync**: Service Worker lifecycle, Background Sync API, Periodic Background Sync API (Chrome).

**Requirements**:
- Service worker registration
- Periodic sync every 30 minutes (use Periodic Background Sync API if available, fallback to setInterval)
- Silent syncs (no user notification unless error)
- Sync all 4 types via orchestrator API
- Battery and network-aware (skip on low battery or no network)

**Files**: frontend/src/sw.ts, frontend/vite.config.ts (PWA plugin config)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Service Worker with background sync</name>
  <files>frontend/src/sw.ts</files>
  <action>
    Implement service worker with periodic sync (30-min interval).
    Use Periodic Background Sync API (navigator.serviceWorker.ready, registration.periodicSync.register).
    Call GET /api/sync/status + trigger syncs via orchestrator.
  </action>
  <verify>Service worker registers, syncs trigger in background</verify>
  <done>Service worker with background sync created. TypeScript passes.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>PWA background sync service</what-built>
  <how-to-verify>
    1. Deploy PWA, open in Chrome
    2. Verify service worker registered (DevTools > Application > Service Workers)
    3. Wait 30 minutes, check logs for background sync execution
    4. Close browser tab, verify syncs still run
    5. Test on low battery, verify sync skipped
    6. Test offline, verify sync queued until online

    Success: Background syncs run silently every 30min, network/battery aware.
  </how-to-verify>
  <resume-signal>Type "approved"</resume-signal>
</task>

</tasks>

<success_criteria>
- Service Worker with Periodic Background Sync
- 30-minute silent sync cycles
- Network and battery aware
- User verification passed
</success_criteria>

<output>
Create `.planning/phases/24-background-sync-service/24-01-SUMMARY.md`
</output>
