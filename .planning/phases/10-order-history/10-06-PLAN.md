---
phase: 10-order-history
plan: 06
type: execute
---

<objective>
Build React timeline UI components with banking app style (expandable cards, temporal grouping, status timeline).

Purpose: Create reusable components for displaying order history in banking app style timeline - collapsed/expanded cards, grouped by period, with status updates.
Output: OrderCard, OrderTimeline, and temporal grouping components ready for integration in OrderHistory page.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-order-history/10-CONTEXT.md
@.planning/phases/10-order-history/10-RESEARCH.md

**CONTEXT.md Requirements:**
- Banking app style (Intesa/UniCredit reference)
- Card compatte per default, tap per espandere
- Raggruppamento temporale: Oggi, Questa settimana, Questo mese, Più vecchi
- Espansione inline (no cambio schermata)
- Badge "Tracking disponibile" quando presente
- Pulsante "Vedi documenti" sempre visibile

**Existing UI Patterns (Phase 8):**
- Yellow banner offline indicator (banking app style)
- Card-based UI components
- Subtle, non-intrusive feedback

**Key Files:**
@archibald-web-app/frontend/src/components/ (create new components)

**Tech Stack:**
- React 19.x
- CSS modules or inline styles (project convention)
- TypeScript with strict types
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create OrderCard component (collapsed/expanded states)</name>
  <files>archibald-web-app/frontend/src/components/OrderCard.tsx, archibald-web-app/frontend/src/components/OrderCard.module.css</files>
  <action>
    Create OrderCard component with two states:

    1. **Component interface:**
       ```typescript
       interface OrderCardProps {
         order: Order;           // From API
         expanded: boolean;
         onToggle: () => void;
       }

       interface Order {
         id: string;
         date: string;
         customerName: string;
         total: string;
         status: string;
         tracking?: { courier: string; trackingNumber: string };
         documents?: Array<{ type: string; name: string; url: string }>;
         // Full detail fields when expanded
         items?: OrderItem[];
         statusTimeline?: StatusUpdate[];
       }
       ```

    2. **Collapsed view (always visible):**
       - Customer name (bold, larger text)
       - Date (formatted: "15 gen 2026")
       - Total (right-aligned: "1.234,56 €")
       - Status badge (colored: green=Evaso, blue=In lavorazione, purple=Spedito)
       - Badge "Tracking disponibile" if order.tracking exists (subtle, right side)
       - Button "Vedi documenti" (text button, always visible)
       - Expand/collapse icon (chevron down/up)

    3. **Expanded view (shown when expanded=true):**
       - All collapsed content above
       - Article list (OrderItems component - create in same file)
       - Status timeline (OrderTimeline component - Task 2)
       - Customer info (name + any address/notes from detail)
       - Tracking details: "Corriere: BRT - Tracking: 123456789" (when available)
       - Documents list with clickable links

    4. **Styling (banking app reference):**
       - White card with subtle shadow
       - Border radius: 12px
       - Padding: 16px
       - Hover state: slightly darker shadow
       - Status badges: rounded pill shape, colored background
       - Smooth expand/collapse animation (CSS transition)

    5. **Click handling:**
       - Click anywhere on card → call onToggle()
       - Click "Vedi documenti" → open document (preventDefault, handle separately)
       - Click tracking badge → show tracking detail (if collapsed)

    Use CSS modules for styling (banking app aesthetic).
    Keep component simple and focused (no API calls here).
  </action>
  <verify>
    TypeScript compiles without errors:
    cd archibald-web-app/frontend && npx tsc --noEmit
  </verify>
  <done>OrderCard component created with collapsed/expanded states and banking app styling</done>
</task>

<task type="auto">
  <name>Task 2: Create OrderTimeline component for status updates</name>
  <files>archibald-web-app/frontend/src/components/OrderTimeline.tsx, archibald-web-app/frontend/src/components/OrderTimeline.module.css</files>
  <action>
    Create OrderTimeline component for displaying status history:

    1. **Component interface:**
       ```typescript
       interface OrderTimelineProps {
         updates: StatusUpdate[];
       }

       interface StatusUpdate {
         status: string;
         timestamp: string;  // ISO 8601
         note?: string;
       }
       ```

    2. **Timeline UI (vertical):**
       - Vertical line connecting status dots
       - Each status: dot + status name + timestamp + optional note
       - Newest at top, oldest at bottom
       - Current status (first item) highlighted differently

    3. **Styling (banking app tracking reference):**
       - Vertical line: 2px solid gray, left side
       - Status dots: 12px circle, colored by status type
       - Current status: larger dot (16px), bold text
       - Timestamps: smaller, gray text (e.g., "15 gen, 14:30")
       - Spacing: 20px between updates

    4. **Status colors:**
       - "In lavorazione": blue
       - "Evaso": green
       - "Spedito": purple
       - Others: gray

    5. **Empty state:**
       - If updates.length === 0, show single entry from order date
       - "Creato" + order.date

    Use CSS flexbox for layout.
    Format timestamps: "dd MMM, HH:mm" (e.g., "15 gen, 14:30").
  </action>
  <verify>
    TypeScript compiles without errors:
    cd archibald-web-app/frontend && npx tsc --noEmit
  </verify>
  <done>OrderTimeline component created with vertical timeline and status color coding</done>
</task>

<task type="auto">
  <name>Task 3: Implement temporal grouping logic</name>
  <files>archibald-web-app/frontend/src/utils/orderGrouping.ts</files>
  <action>
    Create utility function for grouping orders by time period:

    1. **Function signature:**
       ```typescript
       export function groupOrdersByPeriod(orders: Order[]): OrderGroup[] {
         // Implementation
       }

       interface OrderGroup {
         period: 'Oggi' | 'Questa settimana' | 'Questo mese' | 'Più vecchi';
         orders: Order[];
       }
       ```

    2. **Grouping logic:**
       - "Oggi": order.date is today
       - "Questa settimana": order.date within last 7 days (excluding today)
       - "Questo mese": order.date within current month (excluding this week)
       - "Più vecchi": order.date before current month

    3. **Implementation:**
       - Parse order.date (ISO 8601 string)
       - Compare with current date/time
       - Group orders into 4 buckets
       - Return array of OrderGroup (order: Oggi → Settimana → Mese → Vecchi)
       - Within each group, sort orders by date descending (newest first)

    4. **Edge cases:**
       - Empty orders array → return empty array
       - All orders in same period → return single group
       - Invalid dates → log warning, group as "Più vecchi"

    Use native Date objects for comparison.
    Export as pure function (no side effects).
  </action>
  <verify>
    TypeScript compiles without errors:
    cd archibald-web-app/frontend && npx tsc --noEmit
  </verify>
  <done>Temporal grouping utility created with period categorization logic</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] OrderCard component created with collapsed/expanded states
- [ ] OrderTimeline component created with vertical timeline
- [ ] Temporal grouping utility function created
- [ ] Banking app styling applied (cards, badges, timeline)
- [ ] TypeScript compilation passes without errors
- [ ] Components are reusable and prop-driven (no internal state/API calls)
</verification>

<success_criteria>
- OrderCard displays collapsed and expanded views correctly
- Status badges and tracking badge match CONTEXT.md requirements
- OrderTimeline shows vertical status history with timestamps
- Temporal grouping categorizes orders into 4 periods correctly
- Banking app aesthetic (Intesa/UniCredit reference) achieved
- Components ready for integration in OrderHistory page (Plan 10-07)
- No TypeScript errors introduced
</success_criteria>

<output>
After completion, create `.planning/phases/10-order-history/10-06-SUMMARY.md`:

# Phase 10 Plan 06: Timeline UI Components Summary

**Built React timeline UI components with banking app style - expandable cards, temporal grouping, and status timeline.**

## Accomplishments

- Created OrderCard component with collapsed/expanded states
- Created OrderTimeline component for vertical status history
- Implemented temporal grouping utility (Oggi, Settimana, Mese, Vecchi)
- Applied banking app styling (cards, badges, timeline)
- Status color coding and tracking/documents badges

## Files Created/Modified

- `archibald-web-app/frontend/src/components/OrderCard.tsx` - Expandable order card
- `archibald-web-app/frontend/src/components/OrderCard.module.css` - Card styling
- `archibald-web-app/frontend/src/components/OrderTimeline.tsx` - Status timeline
- `archibald-web-app/frontend/src/components/OrderTimeline.module.css` - Timeline styling
- `archibald-web-app/frontend/src/utils/orderGrouping.ts` - Temporal grouping

## Decisions Made

[Styling approach, expand/collapse interaction, or grouping period definitions]

## Issues Encountered

[Any styling challenges, component design trade-offs, or timeline rendering issues]

## Next Step

Ready for Plan 10-07 (Order History Page & Integration) to assemble components into full page.
</output>
