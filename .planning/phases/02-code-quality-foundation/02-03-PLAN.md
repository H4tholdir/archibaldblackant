---
phase: 02-code-quality-foundation
plan: 03
type: execute
---

<objective>
Replace remaining console.log statements in archibald-bot, browser-pool, and session-manager.

Purpose: Complete logger migration for all backend services.
Output: All production code using Winston logger, zero console.log remaining (except backup files).
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-code-quality-foundation/02-02-SUMMARY.md
@src/logger.ts
@src/archibald-bot.ts
@src/browser-pool.ts
@src/session-manager.ts

**From previous plan:**
- Sync services now use logger
- Logger pattern established

**Remaining console.log:**
- archibald-bot.ts (most complex automation logic)
- browser-pool.ts (browser lifecycle management)
- session-manager.ts (session handling)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace console.log in archibald-bot.ts</name>
  <files>src/archibald-bot.ts</files>
  <action>
Replace all console.log() with logger calls in archibald-bot.ts:
- Add import: `import { logger } from './logger'` at top
- Debug selector info → logger.debug()
- Login/navigation steps → logger.info()
- Fallback attempts → logger.warn()
- Puppeteer errors → logger.error()
- Add metadata: { selector, attemptNumber, pageUrl, elementCount }

This file has complex automation logic - preserve all debug information that helps troubleshoot Puppeteer issues.

DO NOT change any automation logic, selectors, or error handling.
  </action>
  <verify>grep "console\.log" src/archibald-bot.ts --exclude="*.backup*" returns empty</verify>
  <done>No console.log in archibald-bot.ts (excluding backups), logger used throughout</done>
</task>

<task type="auto">
  <name>Task 2: Replace console.log in browser-pool and session-manager</name>
  <files>src/browser-pool.ts, src/session-manager.ts</files>
  <action>
For browser-pool.ts:
- Add logger import if missing
- Replace console.log with logger calls
- Pool lifecycle events → logger.info()
- Browser acquisition/release → logger.debug()
- Pool health checks → logger.debug()
- Metadata: { poolSize, availableBrowsers, sessionId }

For session-manager.ts:
- Add logger import if missing
- Replace console.log with logger calls
- Session creation/destruction → logger.info()
- Session reuse → logger.debug()
- Session errors → logger.error()
- Metadata: { sessionId, userId, isReused }

Preserve all diagnostic information for debugging.
  </action>
  <verify>grep "console\.log" src/browser-pool.ts src/session-manager.ts --exclude="*.backup*" returns empty</verify>
  <done>No console.log in browser-pool or session-manager, logger integrated</done>
</task>

<task type="auto">
  <name>Task 3: Final verification - no console.log remains in production code</name>
  <files>N/A</files>
  <action>
Run comprehensive verification:
1. Grep all source files excluding backups: `grep -r "console\.log" src/ --exclude="*.backup*" | wc -l` (should be 0)
2. List any remaining console.log for manual review: `grep -r "console\.log" src/ --exclude="*.backup*"`
3. TypeScript compilation: `npx tsc --noEmit` (should pass)
4. Verify logger imports present in: archibald-bot.ts, browser-pool.ts, session-manager.ts

If any console.log remains in production code (non-backup files), replace it.
Manual test scripts in src/scripts/ can keep console.log (they're not production code).
  </action>
  <verify>grep returns 0 console.log in src/ excluding backups and scripts/, TypeScript compiles</verify>
  <done>Zero console.log in production code, TypeScript clean, logger migration complete</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] No console.log in archibald-bot.ts (excluding backups)
- [ ] No console.log in browser-pool.ts
- [ ] No console.log in session-manager.ts
- [ ] TypeScript compilation passes
- [ ] Grep verification shows 0 instances in production code
</verification>

<success_criteria>
- All 3 tasks completed
- All console.log replaced in production code
- Manual test scripts untouched (they can keep console.log)
- No TypeScript errors
- Logging information preserved
</success_criteria>

<output>
After completion, create `.planning/phases/02-code-quality-foundation/02-03-SUMMARY.md`:

# Phase 2 Plan 03: Replace console.log in Bot & Pool

**Logger migration complete - zero console.log in production code**

## Accomplishments

- Replaced console.log in archibald-bot.ts
- Replaced console.log in browser-pool.ts
- Replaced console.log in session-manager.ts
- Final verification confirms 0 console.log in production code
- All services now use structured Winston logging

## Files Created/Modified

- `src/archibald-bot.ts` - Logger integration
- `src/browser-pool.ts` - Logger integration
- `src/session-manager.ts` - Logger integration

## Decisions Made

[Document any decisions about logging in complex automation code]

## Issues Encountered

[Document any problems and resolutions, or "None"]

## Next Step

Ready for 02-04-PLAN.md (Remove type any in Database Layer)
</output>
