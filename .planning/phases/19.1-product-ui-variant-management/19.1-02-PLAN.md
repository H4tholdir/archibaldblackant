# Phase 19.1 Plan 02: ProductCard Enhancement with All 26+ Fields

<objective>
Refactor ProductCard component to display all 26+ PDF fields in organized sections, add price badges (estimated/unavailable), and maintain mobile-responsive layout.
</objective>

<execution_context>
@archibald-web-app/frontend/src/components/ProductCard.tsx
@archibald-web-app/frontend/src/api/products.ts
@.planning/phases/19.1-product-ui-variant-management/19.1-CONTEXT.md
@.planning/codebase/CONVENTIONS.md
@.planning/codebase/STRUCTURE.md
</execution_context>

<context>
**Current State (from ProductCard.tsx):**
- Shows ~12 fields currently:
  - Header: name, description, groupCode, price, packageContent
  - Expanded: productGroupId, productGroupDescription, minQty, multipleQty, maxQty, priceUnit, searchName, imageDownloadedAt
- 4 sections: Gruppo Prodotto, Informazioni Confezione, Prezzi e IVA, Informazioni Aggiuntive
- Image display with placeholder fallback
- Expand/collapse functionality working
- Mobile-responsive grid layout (repeat(auto-fit, minmax(250px, 1fr)))

**Missing Fields (from Product interface in product-db.ts):**

**Page 4-5 fields:**
- figure (FIGURA)
- size (GRANDEZZA)
- bulkArticleId (ID IN BLOCCO DELL'ARTICOLO)
- legPackage (PACCO GAMBA)
- configurationId (ID DI CONFIGURAZIONE)
- createdBy, createdDate, dataAreaId

**Page 6-7 fields:**
- defaultQty (QT√Ä PREDEFINITA)
- standardQty (QT√Ä STANDARD)
- displayProductNumber (VISUALIZZA IL NUMERO DI PRODOTTO)
- totalAbsoluteDiscount (SCONTO ASSOLUTO TOTALE)
- lineDiscount (SCONTO LINEA)
- productId (ID duplicate?)
- modifiedBy, modifiedDatetime
- orderableArticle (ARTICOLO ORDINABILE)
- stopped (FERMATO)

**Page 8 fields:**
- purchPrice (PURCH PRICE)
- pcsStandardConfigurationId (PCS ID DI CONFIGURAZIONE STANDARD)
- unitId (ID UNIT√Ä)

**From Phase 19.1 Context:**
- ‚ö†Ô∏è Prices come from Excel listino (Phase 4.1-02)
- Show badge if `priceSource === 'default'` ‚Üí "‚ö†Ô∏è Prezzo stimato"
- Show placeholder if `price === null` ‚Üí "Prezzo non disponibile"
- Maintain existing price/VAT display logic

**From Phase 3 Pattern:**
- OrderForm shows packageContent in autocomplete suggestions
- Quantity validation uses minQty, multipleQty, maxQty
- Clean, readable UI with proper spacing

**Design Requirements:**
- Organize fields into logical sections (Identificazione, Caratteristiche, Quantit√†, Pricing, Metadati)
- Collapsible sections for advanced fields (avoid overwhelming users)
- Highlight important fields: Figura, Grandezza, Contenuto Imballaggio, Quantit√† Standard, Sconti
- Mobile-responsive (works on phone screens 375px+)
- Consistent with existing design system (same colors, spacing, typography)

**Tech Stack:**
- React 19 functional components
- Inline styles (no CSS modules)
- Type-safe with TypeScript
- Product interface from backend/src/product-db.ts
</context>

<tasks>

## Task 1: Extend Product type in frontend API

**File:** `archibald-web-app/frontend/src/api/products.ts`

Add missing fields to Product interface to match backend (ensure type consistency):

```typescript
export interface Product {
  // ========== CORE FIELDS ==========
  id: string;
  name: string;
  description?: string;

  // ========== IDENTIFICATION ==========
  searchName?: string;
  displayProductNumber?: string;

  // ========== CHARACTERISTICS ==========
  figure?: string; // ‚≠ê NEW
  size?: string; // ‚≠ê NEW
  packageContent?: string;
  groupCode?: string;
  productGroupId?: string;
  productGroupDescription?: string;
  bulkArticleId?: string;
  legPackage?: string;
  configurationId?: string;
  pcsStandardConfigurationId?: string;

  // ========== QUANTITY ==========
  minQty?: number;
  multipleQty?: number;
  maxQty?: number;
  standardQty?: string; // ‚≠ê NEW (string in DB)
  defaultQty?: string; // ‚≠ê NEW (string in DB)
  unitId?: string;

  // ========== PRICING & DISCOUNTS ==========
  price?: number;
  priceSource?: "archibald" | "excel" | null;
  priceUpdatedAt?: number;
  priceCurrency?: string;
  vat?: number;
  vatSource?: "archibald" | "excel" | null;
  vatUpdatedAt?: number;
  priceUnit?: string;
  lineDiscount?: string; // ‚≠ê NEW
  totalAbsoluteDiscount?: string; // ‚≠ê NEW
  purchPrice?: string; // ‚≠ê NEW

  // ========== METADATA ==========
  createdBy?: string;
  createdDate?: string;
  modifiedBy?: string;
  modifiedDatetime?: string;
  dataAreaId?: string;
  orderableArticle?: string;
  stopped?: string;
  productId?: string;

  // ========== IMAGE ==========
  imageLocalPath?: string;
  imageDownloadedAt?: number;

  // ========== SYSTEM ==========
  hash?: string;
  lastSync?: number;

  // ========== EXCEL LISTINO FIELDS (from Phase 4.1) ==========
  accountCode?: string;
  accountDescription?: string;
  priceValidFrom?: string;
  priceValidTo?: string;
  priceQtyFrom?: string;
  priceQtyTo?: string;
}
```

**Rationale:**
- Matches backend Product interface exactly
- New fields marked with ‚≠ê for clarity
- Keeps existing fields for backwards compatibility
- Proper TypeScript types (string vs number as per DB schema)

## Task 2: Refactor ProductCard component structure

**File:** `archibald-web-app/frontend/src/components/ProductCard.tsx`

Reorganize component into 6 logical sections:

```typescript
import type { Product } from "../api/products";

interface ProductCardProps {
  product: Product;
  expanded: boolean;
  onToggle: () => void;
  showVariantBadge?: boolean; // NEW: Optional badge showing variant count
  variantCount?: number; // NEW: Number of variants for this product
}

export function ProductCard({
  product,
  expanded,
  onToggle,
  showVariantBadge = false,
  variantCount = 1,
}: ProductCardProps) {
  // Utility functions
  const formatCurrency = (amount: number | null | undefined): string => {
    if (amount === null || amount === undefined || amount === 0)
      return "‚Ç¨ 0,00";
    return new Intl.NumberFormat("it-IT", {
      style: "currency",
      currency: "EUR",
    }).format(amount);
  };

  const formatDate = (timestamp: number | null | undefined): string => {
    if (!timestamp) return "N/A";
    const date = new Date(timestamp * 1000);
    return date.toLocaleDateString("it-IT", {
      day: "2-digit",
      month: "2-digit",
      year: "numeric",
    });
  };

  const formatDateString = (dateStr: string | null | undefined): string => {
    if (!dateStr) return "N/A";
    // Handle various date formats from Archibald
    try {
      const date = new Date(dateStr);
      if (isNaN(date.getTime())) return dateStr; // Return original if invalid
      return date.toLocaleDateString("it-IT", {
        day: "2-digit",
        month: "2-digit",
        year: "numeric",
      });
    } catch {
      return dateStr;
    }
  };

  // Get product image URL or placeholder
  const imageUrl = product.imageLocalPath
    ? `/api/${product.imageLocalPath}`
    : "https://via.placeholder.com/150?text=No+Image";

  // Price badge logic
  const getPriceBadge = () => {
    if (product.price === null || product.price === undefined) {
      return {
        text: "‚ö†Ô∏è Prezzo non disponibile",
        bgColor: "#ffebee",
        color: "#c62828",
      };
    }
    if (product.priceSource === "default") {
      return {
        text: "‚ö†Ô∏è Prezzo stimato",
        bgColor: "#fff3e0",
        color: "#f57c00",
      };
    }
    return null;
  };

  const priceBadge = getPriceBadge();

  return (
    <div
      style={{
        backgroundColor: "#fff",
        borderRadius: "12px",
        boxShadow: "0 2px 8px rgba(0, 0, 0, 0.1)",
        overflow: "hidden",
        transition: "all 0.3s",
      }}
    >
      {/* Card Header - KEEP EXISTING */}
      <div
        onClick={onToggle}
        style={{
          padding: "20px",
          cursor: "pointer",
          transition: "background-color 0.2s",
        }}
        onMouseEnter={(e) => {
          e.currentTarget.style.backgroundColor = "#f5f5f5";
        }}
        onMouseLeave={(e) => {
          e.currentTarget.style.backgroundColor = "#fff";
        }}
      >
        <div
          style={{
            display: "flex",
            justifyContent: "space-between",
            alignItems: "flex-start",
            gap: "16px",
          }}
        >
          {/* Product Image - KEEP EXISTING */}
          <div
            style={{
              width: "80px",
              height: "80px",
              flexShrink: 0,
              borderRadius: "8px",
              overflow: "hidden",
              backgroundColor: "#f5f5f5",
            }}
          >
            <img
              src={imageUrl}
              alt={product.name}
              style={{
                width: "100%",
                height: "100%",
                objectFit: "cover",
              }}
              onError={(e) => {
                e.currentTarget.src =
                  "https://via.placeholder.com/150?text=No+Image";
              }}
            />
          </div>

          {/* Product info - ENHANCED */}
          <div style={{ flex: 1 }}>
            <div
              style={{
                fontSize: "18px",
                fontWeight: 700,
                color: "#333",
                marginBottom: "4px",
              }}
            >
              {product.name}
              {/* NEW: Variant badge */}
              {showVariantBadge && variantCount > 1 && (
                <span
                  style={{
                    marginLeft: "8px",
                    fontSize: "12px",
                    fontWeight: 600,
                    padding: "4px 8px",
                    borderRadius: "12px",
                    backgroundColor: "#e3f2fd",
                    color: "#1976d2",
                  }}
                >
                  {variantCount} confezioni
                </span>
              )}
            </div>
            <div
              style={{
                fontSize: "14px",
                color: "#666",
                marginBottom: "8px",
              }}
            >
              {product.description || "Nessuna descrizione"}
            </div>
            <div
              style={{
                display: "flex",
                gap: "16px",
                flexWrap: "wrap",
                fontSize: "13px",
                color: "#666",
              }}
            >
              <span>
                <strong>Codice:</strong> {product.id}
              </span>
              {product.groupCode && (
                <span>
                  <strong>Gruppo:</strong> {product.groupCode}
                </span>
              )}
              {/* NEW: Show key characteristics in header */}
              {product.figure && (
                <span>
                  <strong>Figura:</strong> {product.figure}
                </span>
              )}
              {product.size && (
                <span>
                  <strong>Grandezza:</strong> {product.size}
                </span>
              )}
              {product.packageContent && (
                <span>
                  <strong>Confezione:</strong> {product.packageContent}
                </span>
              )}
            </div>
          </div>

          {/* Expand icon - KEEP EXISTING */}
          <div
            style={{
              fontSize: "24px",
              color: "#1976d2",
              transition: "transform 0.3s",
              transform: expanded ? "rotate(180deg)" : "rotate(0deg)",
              flexShrink: 0,
            }}
          >
            ‚ñº
          </div>
        </div>
      </div>

      {/* Expanded Details - CONTINUE IN NEXT TASK */}
    </div>
  );
}
```

**Rationale:**
- Added utility functions for date formatting (handles timestamp and string dates)
- Price badge logic centralized (estimated/unavailable warnings)
- Variant badge in header (shows "3 confezioni" if multiple variants)
- Key fields (figura, grandezza, packageContent) promoted to header for quick scanning
- Maintains existing hover effects and expand icon

## Task 3: Create expanded details sections

**File:** `archibald-web-app/frontend/src/components/ProductCard.tsx` (continued)

Add 6 organized sections inside `{expanded && (...)}` block:

```typescript
      {/* Expanded Details */}
      {expanded && (
        <div
          style={{
            borderTop: "1px solid #e0e0e0",
            padding: "20px",
            backgroundColor: "#fafafa",
          }}
        >
          {/* SECTION 1: Identificazione */}
          {(product.id ||
            product.searchName ||
            product.displayProductNumber ||
            product.productId) && (
            <div style={{ marginBottom: "20px" }}>
              <h3
                style={{
                  fontSize: "16px",
                  fontWeight: 700,
                  color: "#333",
                  marginBottom: "12px",
                }}
              >
                üîç Identificazione
              </h3>
              <div
                style={{
                  display: "grid",
                  gridTemplateColumns: "repeat(auto-fit, minmax(250px, 1fr))",
                  gap: "12px",
                  fontSize: "14px",
                }}
              >
                <div>
                  <strong style={{ color: "#666" }}>ID Articolo:</strong>{" "}
                  {product.id}
                </div>
                {product.searchName && (
                  <div>
                    <strong style={{ color: "#666" }}>Nome ricerca:</strong>{" "}
                    {product.searchName}
                  </div>
                )}
                {product.displayProductNumber && (
                  <div>
                    <strong style={{ color: "#666" }}>Numero prodotto:</strong>{" "}
                    {product.displayProductNumber}
                  </div>
                )}
                {product.productId && product.productId !== product.id && (
                  <div>
                    <strong style={{ color: "#666" }}>ID Prodotto:</strong>{" "}
                    {product.productId}
                  </div>
                )}
              </div>
            </div>
          )}

          {/* SECTION 2: Caratteristiche */}
          {(product.figure ||
            product.size ||
            product.packageContent ||
            product.groupCode ||
            product.productGroupId ||
            product.productGroupDescription ||
            product.bulkArticleId ||
            product.legPackage ||
            product.configurationId ||
            product.pcsStandardConfigurationId) && (
            <div style={{ marginBottom: "20px" }}>
              <h3
                style={{
                  fontSize: "16px",
                  fontWeight: 700,
                  color: "#333",
                  marginBottom: "12px",
                }}
              >
                üìê Caratteristiche
              </h3>
              <div
                style={{
                  display: "grid",
                  gridTemplateColumns: "repeat(auto-fit, minmax(250px, 1fr))",
                  gap: "12px",
                  fontSize: "14px",
                }}
              >
                {product.figure && (
                  <div>
                    <strong style={{ color: "#666" }}>‚≠ê Figura:</strong>{" "}
                    <span style={{ fontWeight: 600, color: "#1976d2" }}>
                      {product.figure}
                    </span>
                  </div>
                )}
                {product.size && (
                  <div>
                    <strong style={{ color: "#666" }}>‚≠ê Grandezza:</strong>{" "}
                    <span style={{ fontWeight: 600, color: "#1976d2" }}>
                      {product.size}
                    </span>
                  </div>
                )}
                {product.packageContent && (
                  <div>
                    <strong style={{ color: "#666" }}>‚≠ê Contenuto imballaggio:</strong>{" "}
                    <span style={{ fontWeight: 600, color: "#1976d2" }}>
                      {product.packageContent}
                    </span>
                  </div>
                )}
                {product.groupCode && (
                  <div>
                    <strong style={{ color: "#666" }}>Gruppo articolo:</strong>{" "}
                    {product.groupCode}
                  </div>
                )}
                {product.productGroupDescription && (
                  <div>
                    <strong style={{ color: "#666" }}>Descrizione gruppo:</strong>{" "}
                    {product.productGroupDescription}
                  </div>
                )}
                {product.productGroupId && (
                  <div>
                    <strong style={{ color: "#666" }}>ID gruppo prodotti:</strong>{" "}
                    {product.productGroupId}
                  </div>
                )}
                {product.bulkArticleId && (
                  <div>
                    <strong style={{ color: "#666" }}>ID blocco articolo:</strong>{" "}
                    {product.bulkArticleId}
                  </div>
                )}
                {product.legPackage && (
                  <div>
                    <strong style={{ color: "#666" }}>Pacco gamba:</strong>{" "}
                    {product.legPackage}
                  </div>
                )}
                {product.configurationId && (
                  <div>
                    <strong style={{ color: "#666" }}>ID configurazione:</strong>{" "}
                    {product.configurationId}
                  </div>
                )}
                {product.pcsStandardConfigurationId && (
                  <div>
                    <strong style={{ color: "#666" }}>PCS ID configurazione:</strong>{" "}
                    {product.pcsStandardConfigurationId}
                  </div>
                )}
              </div>
            </div>
          )}

          {/* SECTION 3: Quantit√† */}
          {(product.minQty !== undefined ||
            product.multipleQty !== undefined ||
            product.maxQty !== undefined ||
            product.standardQty ||
            product.defaultQty ||
            product.unitId) && (
            <div style={{ marginBottom: "20px" }}>
              <h3
                style={{
                  fontSize: "16px",
                  fontWeight: 700,
                  color: "#333",
                  marginBottom: "12px",
                }}
              >
                üìä Quantit√†
              </h3>
              <div
                style={{
                  display: "grid",
                  gridTemplateColumns: "repeat(auto-fit, minmax(200px, 1fr))",
                  gap: "12px",
                  fontSize: "14px",
                }}
              >
                {product.minQty !== undefined && product.minQty !== null && (
                  <div>
                    <strong style={{ color: "#666" }}>Qt√† minima:</strong>{" "}
                    {product.minQty}
                  </div>
                )}
                {product.multipleQty !== undefined &&
                  product.multipleQty !== null && (
                    <div>
                      <strong style={{ color: "#666" }}>Qt√† in multipli:</strong>{" "}
                      {product.multipleQty}
                    </div>
                  )}
                {product.maxQty !== undefined && product.maxQty !== null && (
                  <div>
                    <strong style={{ color: "#666" }}>Qt√† massima:</strong>{" "}
                    {product.maxQty}
                  </div>
                )}
                {product.standardQty && (
                  <div>
                    <strong style={{ color: "#666" }}>‚≠ê Qt√† standard:</strong>{" "}
                    <span style={{ fontWeight: 600, color: "#1976d2" }}>
                      {product.standardQty}
                    </span>
                  </div>
                )}
                {product.defaultQty && (
                  <div>
                    <strong style={{ color: "#666" }}>‚≠ê Qt√† predefinita:</strong>{" "}
                    <span style={{ fontWeight: 600, color: "#1976d2" }}>
                      {product.defaultQty}
                    </span>
                  </div>
                )}
                {product.unitId && (
                  <div>
                    <strong style={{ color: "#666" }}>Unit√†:</strong>{" "}
                    {product.unitId}
                  </div>
                )}
              </div>
            </div>
          )}

          {/* SECTION 4: Pricing & Sconti */}
          <div style={{ marginBottom: "20px" }}>
            <h3
              style={{
                fontSize: "16px",
                fontWeight: 700,
                color: "#333",
                marginBottom: "12px",
              }}
            >
              üí∞ Prezzi e Sconti
            </h3>
            <div
              style={{
                display: "grid",
                gridTemplateColumns: "repeat(auto-fit, minmax(200px, 1fr))",
                gap: "12px",
                fontSize: "14px",
              }}
            >
              <div>
                <strong style={{ color: "#666" }}>Prezzo:</strong>{" "}
                {formatCurrency(product.price)}{" "}
                {product.priceCurrency && product.priceCurrency !== "EUR" && (
                  <span style={{ color: "#999" }}>({product.priceCurrency})</span>
                )}
                {product.priceSource && (
                  <span
                    style={{
                      marginLeft: "8px",
                      fontSize: "12px",
                      padding: "2px 6px",
                      borderRadius: "4px",
                      backgroundColor:
                        product.priceSource === "excel" ? "#e3f2fd" : "#fff3e0",
                      color:
                        product.priceSource === "excel" ? "#1976d2" : "#f57c00",
                    }}
                  >
                    {product.priceSource === "excel" ? "Excel" : "Archibald"}
                  </span>
                )}
                {priceBadge && (
                  <div
                    style={{
                      marginTop: "4px",
                      fontSize: "12px",
                      padding: "4px 8px",
                      borderRadius: "4px",
                      backgroundColor: priceBadge.bgColor,
                      color: priceBadge.color,
                      display: "inline-block",
                    }}
                  >
                    {priceBadge.text}
                  </div>
                )}
              </div>
              {product.vat !== undefined && product.vat !== null && (
                <div>
                  <strong style={{ color: "#666" }}>IVA:</strong> {product.vat}%{" "}
                  {product.vatSource && (
                    <span
                      style={{
                        marginLeft: "8px",
                        fontSize: "12px",
                        padding: "2px 6px",
                        borderRadius: "4px",
                        backgroundColor: "#e8f5e9",
                        color: "#2e7d32",
                      }}
                    >
                      {product.vatSource}
                    </span>
                  )}
                </div>
              )}
              {product.priceUnit && (
                <div>
                  <strong style={{ color: "#666" }}>Unit√† prezzo:</strong>{" "}
                  {product.priceUnit}
                </div>
              )}
              {product.lineDiscount && (
                <div>
                  <strong style={{ color: "#666" }}>‚≠ê Sconto linea:</strong>{" "}
                  <span style={{ fontWeight: 600, color: "#1976d2" }}>
                    {product.lineDiscount}
                  </span>
                </div>
              )}
              {product.totalAbsoluteDiscount && (
                <div>
                  <strong style={{ color: "#666" }}>‚≠ê Sconto assoluto totale:</strong>{" "}
                  <span style={{ fontWeight: 600, color: "#1976d2" }}>
                    {product.totalAbsoluteDiscount}
                  </span>
                </div>
              )}
              {product.purchPrice && (
                <div>
                  <strong style={{ color: "#666" }}>Prezzo acquisto:</strong>{" "}
                  {product.purchPrice}
                </div>
              )}
              {product.accountDescription && (
                <div>
                  <strong style={{ color: "#666" }}>Account:</strong>{" "}
                  {product.accountDescription}
                  {product.accountCode && (
                    <span style={{ color: "#999", marginLeft: "4px" }}>
                      ({product.accountCode})
                    </span>
                  )}
                </div>
              )}
              {product.priceValidFrom && product.priceValidTo && (
                <div>
                  <strong style={{ color: "#666" }}>Validit√† prezzo:</strong>{" "}
                  {product.priceValidFrom} ‚Üí {product.priceValidTo}
                </div>
              )}
              {product.priceQtyFrom && product.priceQtyTo && (
                <div>
                  <strong style={{ color: "#666" }}>Range quantit√†:</strong>{" "}
                  {product.priceQtyFrom} - {product.priceQtyTo}
                </div>
              )}
            </div>
          </div>

          {/* SECTION 5: Metadati */}
          {(product.createdBy ||
            product.createdDate ||
            product.modifiedBy ||
            product.modifiedDatetime ||
            product.dataAreaId ||
            product.orderableArticle ||
            product.stopped) && (
            <div style={{ marginBottom: "20px" }}>
              <h3
                style={{
                  fontSize: "16px",
                  fontWeight: 700,
                  color: "#333",
                  marginBottom: "12px",
                }}
              >
                üè∑Ô∏è Metadati
              </h3>
              <div
                style={{
                  display: "grid",
                  gridTemplateColumns: "repeat(auto-fit, minmax(250px, 1fr))",
                  gap: "12px",
                  fontSize: "14px",
                }}
              >
                {product.createdBy && (
                  <div>
                    <strong style={{ color: "#666" }}>Creato da:</strong>{" "}
                    {product.createdBy}
                  </div>
                )}
                {product.createdDate && (
                  <div>
                    <strong style={{ color: "#666" }}>Data creazione:</strong>{" "}
                    {formatDateString(product.createdDate)}
                  </div>
                )}
                {product.modifiedBy && (
                  <div>
                    <strong style={{ color: "#666" }}>Modificato da:</strong>{" "}
                    {product.modifiedBy}
                  </div>
                )}
                {product.modifiedDatetime && (
                  <div>
                    <strong style={{ color: "#666" }}>Data modifica:</strong>{" "}
                    {formatDateString(product.modifiedDatetime)}
                  </div>
                )}
                {product.dataAreaId && (
                  <div>
                    <strong style={{ color: "#666" }}>DataAreaId:</strong>{" "}
                    {product.dataAreaId}
                  </div>
                )}
                {product.orderableArticle && (
                  <div>
                    <strong style={{ color: "#666" }}>Articolo ordinabile:</strong>{" "}
                    <span
                      style={{
                        color:
                          product.orderableArticle.toLowerCase() === "yes" ||
                          product.orderableArticle === "1"
                            ? "#2e7d32"
                            : "#c62828",
                        fontWeight: 600,
                      }}
                    >
                      {product.orderableArticle === "1" ? "S√¨" : product.orderableArticle}
                    </span>
                  </div>
                )}
                {product.stopped && (
                  <div>
                    <strong style={{ color: "#666" }}>Fermato:</strong>{" "}
                    <span
                      style={{
                        color:
                          product.stopped.toLowerCase() === "yes" ||
                          product.stopped === "1"
                            ? "#c62828"
                            : "#2e7d32",
                        fontWeight: 600,
                      }}
                    >
                      {product.stopped === "1" ? "S√¨" : product.stopped}
                    </span>
                  </div>
                )}
                {product.lastSync && (
                  <div>
                    <strong style={{ color: "#666" }}>Ultimo sync:</strong>{" "}
                    {formatDate(product.lastSync)}
                  </div>
                )}
              </div>
            </div>
          )}

          {/* SECTION 6: Immagine - KEEP EXISTING */}
          {product.imageLocalPath && (
            <div style={{ marginTop: "20px" }}>
              <h3
                style={{
                  fontSize: "16px",
                  fontWeight: 700,
                  color: "#333",
                  marginBottom: "12px",
                }}
              >
                üñºÔ∏è Immagine Prodotto
              </h3>
              <div
                style={{
                  maxWidth: "400px",
                  borderRadius: "8px",
                  overflow: "hidden",
                  backgroundColor: "#f5f5f5",
                }}
              >
                <img
                  src={imageUrl}
                  alt={product.name}
                  style={{
                    width: "100%",
                    height: "auto",
                  }}
                  onError={(e) => {
                    e.currentTarget.src =
                      "https://via.placeholder.com/400?text=Immagine+Non+Disponibile";
                  }}
                />
              </div>
              {product.imageDownloadedAt && (
                <div
                  style={{
                    marginTop: "8px",
                    fontSize: "13px",
                    color: "#999",
                  }}
                >
                  Scaricata il: {formatDate(product.imageDownloadedAt)}
                </div>
              )}
            </div>
          )}
        </div>
      )}
```

**Rationale:**
- 6 logical sections with emoji icons for quick scanning
- Important fields marked with ‚≠ê and blue highlighting
- Conditional rendering (show section only if has data)
- Price badge displays warning for estimated/unavailable prices
- Boolean fields (orderableArticle, stopped) shown with green/red colors
- Mobile-responsive grid (auto-fit, minmax(250px, 1fr))
- Date formatting handles both timestamp and string formats
- Maintains existing image preview section

</tasks>

<verification>

## Manual Testing Checklist

### 1. Visual Inspection

**Test all sections render correctly:**
- Navigate to /articoli page
- Click on a product card to expand
- Verify all 6 sections appear:
  - ‚úì üîç Identificazione
  - ‚úì üìê Caratteristiche
  - ‚úì üìä Quantit√†
  - ‚úì üí∞ Prezzi e Sconti
  - ‚úì üè∑Ô∏è Metadati
  - ‚úì üñºÔ∏è Immagine Prodotto (if image exists)

**Test field display:**
- ‚úì All 26+ fields visible when expanded
- ‚úì Important fields (‚≠ê) highlighted in blue
- ‚úì Sections with no data are hidden
- ‚úì Empty/null fields show gracefully (N/A or omitted)

### 2. Price Badge Testing

**Test price badge scenarios:**

**Scenario 1: Normal price (from Excel)**
```
Product: { price: 24.50, priceSource: "excel" }
Expected: Show price with "Excel" badge, NO warning badge
```

**Scenario 2: Estimated price**
```
Product: { price: 20.00, priceSource: "default" }
Expected: Show price with "Archibald" badge + "‚ö†Ô∏è Prezzo stimato" warning (orange)
```

**Scenario 3: Missing price**
```
Product: { price: null }
Expected: Show "‚Ç¨ 0,00" + "‚ö†Ô∏è Prezzo non disponibile" warning (red)
```

### 3. Variant Badge Testing

**Test variant count badge:**
- Product with 1 variant: Badge should NOT appear
- Product with 3 variants: Badge shows "3 confezioni"
- Badge appears after product name in header
- Badge has blue background (#e3f2fd)

### 4. Mobile Responsiveness

**Test on mobile viewport (375px width):**
```bash
# In browser DevTools
# Resize to iPhone SE (375x667)
```

- ‚úì Card header stacks vertically on narrow screens
- ‚úì Grid layouts switch to single column
- ‚úì Text remains readable (no overflow)
- ‚úì Touch targets large enough (expand icon, buttons)
- ‚úì Images scale correctly

### 5. Data Formatting

**Test date formatting:**
- Timestamp dates (lastSync, imageDownloadedAt): Show as "20/01/2026"
- String dates (createdDate, modifiedDatetime): Parse and format correctly
- Invalid dates: Fallback to "N/A" or original string

**Test currency formatting:**
- Italian locale: "‚Ç¨ 24,50" (comma decimal separator)
- Zero prices: "‚Ç¨ 0,00"
- Null prices: "‚Ç¨ 0,00"

**Test boolean fields:**
- orderableArticle = "1" ‚Üí Show "S√¨" in green
- orderableArticle = "0" ‚Üí Show "No" in red
- stopped = "1" ‚Üí Show "S√¨" in red (warning color)
- stopped = "0" ‚Üí Show "No" in green

### 6. Edge Cases

**Test with minimal product data:**
```json
{
  "id": "TEST001",
  "name": "Minimal Product",
  "price": 10.00
}
```
Expected:
- ‚úì Card renders without errors
- ‚úì Only Identificazione and Pricing sections appear
- ‚úì Empty sections hidden

**Test with all fields populated:**
- ‚úì All 6 sections appear
- ‚úì No visual overflow
- ‚úì Readable on mobile

**Test with long text values:**
- ‚úì Long product names wrap correctly
- ‚úì Long descriptions don't break layout
- ‚úì Grid cells handle overflow gracefully

### 7. Backwards Compatibility

**Test existing functionality:**
- ‚úì OrderForm autocomplete still works
- ‚úì Product search filters work
- ‚úì Manual sync button works
- ‚úì No console errors
- ‚úì No TypeScript errors

### 8. Performance

**Test with large product list (1000+ products):**
- ‚úì Scroll performance smooth
- ‚úì Expand/collapse animation smooth
- ‚úì No memory leaks (check DevTools Memory tab)

</verification>

<success_criteria>
- [ ] Product interface extended with all 26+ fields
- [ ] ProductCard component shows all fields in 6 organized sections
- [ ] Price badges work (estimated/unavailable warnings)
- [ ] Variant badge shows count when showVariantBadge=true
- [ ] Important fields highlighted with ‚≠ê and blue color
- [ ] Boolean fields color-coded (green/red)
- [ ] Mobile-responsive (375px+ width)
- [ ] Date formatting works for timestamps and strings
- [ ] Empty sections hidden conditionally
- [ ] No TypeScript compilation errors
- [ ] No visual regressions on existing pages
- [ ] Manual testing checklist completed
</success_criteria>

<output>
**Deliverables:**
1. Updated `archibald-web-app/frontend/src/api/products.ts` with extended Product interface
2. Refactored `archibald-web-app/frontend/src/components/ProductCard.tsx` with 6 sections and all 26+ fields
3. Price badge logic implemented (estimated/unavailable warnings)
4. Variant badge support added
5. Mobile-responsive layout maintained

**Next Steps:**
- Execute Plan 19.1-03: Create VariantSelector component and update ArticoliList to use grouped mode
</output>
